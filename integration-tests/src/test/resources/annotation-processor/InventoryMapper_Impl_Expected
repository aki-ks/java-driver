package com.datastax.oss.driver.mapper.model.inventory;

import com.datastax.oss.driver.api.core.CqlIdentifier;
import com.datastax.oss.driver.internal.mapper.DaoCacheKey;
import com.datastax.oss.driver.internal.mapper.MapperContext;
import java.lang.Override;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;

/**
 * Do not instantiate this class directly, use {@link InventoryMapperBuilder} instead.
 *
 * <p>Generated by the DataStax driver mapper, do not edit directly.
 */
public class InventoryMapper_Impl implements InventoryMapper {
  private final MapperContext context;

  private final ConcurrentMap<DaoCacheKey, ProductDao> productDaoCache = new ConcurrentHashMap<>();

  public InventoryMapper_Impl(MapperContext context) {
    this.context = context;
  }

  @Override
  public ProductDao productDao(CqlIdentifier keyspace) {
    DaoCacheKey key = new DaoCacheKey(keyspace, (CqlIdentifier)null);
    return productDaoCache.computeIfAbsent(key, k -> ProductDao_Impl.init(context.withKeyspaceAndTable(k.getKeyspaceId(), k.getTableId())));
  }
}
